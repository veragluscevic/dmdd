import numpy as np
cimport numpy as np
cimport cython
from cpython cimport bool

import dmdd.constants as const

STUFF = "Hi" # yup. http://stackoverflow.com/questions/8024805/cython-compiled-c-extension-importerror-dynamic-module-does-not-define-init-fu

DTYPE = np.float
ctypedef np.float_t DTYPE_t
cdef extern from "math.h":
    double exp(double)
    double sqrt(double)
    double sin(double)
    double cos(double)


#physical constants from constants.py:
cdef DTYPE_t mN = const.NUCLEON_MASS # Nucleon mass in GeV
cdef DTYPE_t pmag = const.P_MAGMOM # proton magnetic moment, PDG Live
cdef DTYPE_t nmag = const.N_MAGMOM # neutron magnetic moment, PDG Live


#################

def factor_M(str newstr, DTYPE_t y, DTYPE_t fnfp):
    cdef DTYPE_t result
    if newstr=='Iodine':
        result= 0.+1.0*((2808.9995665607285 - 10034.664748620813*y + 13985.083771812388*y**2 - 9831.9530163515*y**3 + 3822.370838853076*y**4 - 842.3182765716128*y**5 + 102.67798750005514*y**6 - 6.320515311422696*y**7 + 0.1522762130801693*y**8 - 9.197917237199101*10.**-11*y**9 + 7.096086625180321*10.**-20*y**10)/exp(2*y)+fnfp*(3921.985800775472 - 15131.936068913747*y + 23039.49218040388*y**2 - 17978.644733103007*y**3 + 7902.225675181148*y**4 - 2015.089381452502*y**5 + 293.26254308415264*y**6 - 22.583344212234255*y**7 + 0.7502320462933189*y**8 - 0.00481617847482125*y**9 + 1.4176567039928482*10.**-12*y**10)/exp(2*y)+fnfp*(3921.985800775472 - 15131.936068913747*y + 23039.49218040388*y**2 - 17978.644733103007*y**3 + 7902.225675181148*y**4 - 2015.089381452502*y**5 + 293.26254308415264*y**6 - 22.583344212234255*y**7 + 0.7502320462933189*y**8 - 0.00481617847482125*y**9 + 1.4176567039928482*10.**-12*y**10)/exp(2*y)+fnfp**2.*(5475.961194368472 - 22693.147694980555*y + 37521.4281769301*y**2 - 32244.485215252134*y**3 + 15868.16711647535*y**4 - 4625.820676030915*y**5 + 791.8696261376091*y**6 - 74.94891993663992*y**7 + 3.3310497112819077*y**8 - 0.04122588128057741*y**9 + 0.00015274973399967328*y**10)/exp(2*y))
        return result
    elif newstr=='Sodium':
        result= 0.+1.0*((120.9999841400026 - 175.99996808871427*y + 87.22747412364454*y**2 - 17.082501284629895*y**3 + 1.2487710215480443*y**4)/exp(2*y)+fnfp*(131.9999907716084 - 198.66664801858957*y + 101.8139564128383*y**2 - 20.496989390984755*y**3 + 1.5014800579101806*y**4)/exp(2*y)+fnfp*(131.9999907716084 - 198.66664801858957*y + 101.8139564128383*y**2 - 20.496989390984755*y**3 + 1.5014800579101806*y**4)/exp(2*y)+fnfp**2.*(143.9999987400356 - 223.9999981799887*y + 118.69933973331955*y**2 - 24.594952036524546*y**3 + 1.8199127633119492*y**4)/exp(2*y))
        return result
    elif newstr=='Germanium':
        result= 0.+0.2754*((1023.9823771108219 - 2821.3891256910947*y + 2965.3285934458954*y**2 - 1509.593491158375*y**3 + 395.32543129876564*y**4 - 50.98504059983079*y**5 + 2.599077750015335*y**6 - 0.0068781261826406145*y**7 + 4.674703588343593*10.**-6*y**8)/exp(2*y)+fnfp*(1279.9276397746173 - 3692.0895784234294*y + 4070.1302292015816*y**2 - 2179.8522940543*y**3 + 602.5720999065406*y**4 - 82.40804332201884*y**5 + 4.496747371889379*y**6 - 0.017160510611350294*y**7 + 0.000015323385397771546*y**8)/exp(2*y)+fnfp*(1279.9276397746173 - 3692.0895784234294*y + 4070.1302292015816*y**2 - 2179.8522940543*y**3 + 602.5720999065406*y**4 - 82.40804332201884*y**5 + 4.496747371889379*y**6 - 0.017160510611350294*y**7 + 0.000015323385397771546*y**8)/exp(2*y)+fnfp**2.*(1599.8466376748247 - 4821.787175202875*y + 5568.710024606966*y**2 - 3134.7002826097164*y**3 + 914.2875872511705*y**4 - 132.62850886815667*y**5 + 7.757854569689321*y**6 - 0.038597563402939634*y**7 + 0.00005022909701357943*y**8)/exp(2*y))+0.0773*((1023.960324921873 - 2820.716396475882*y + 2943.4295421290785*y**2 - 1474.3061629406645*y**3 + 376.9967894754349*y**4 - 47.22826083842648*y**5 + 2.3403260918044553*y**6 - 0.00581514713579986*y**7 + 3.7378688999244727*10.**-6*y**8)/exp(2*y)+fnfp*(1311.8044949096768 - 3823.7535764226764*y + 4247.431217718782*y**2 - 2285.4213428716967*y**3 + 634.8320959864336*y**4 - 88.00026649784942*y**5 + 5.089987671420709*y**6 - 0.04958373057889356*y**7 + 0.000053179975549796164*y**8)/exp(2*y)+fnfp*(1311.8044949096768 - 3823.7535764226764*y + 4247.431217718782*y**2 - 2285.4213428716967*y**3 + 634.8320959864336*y**4 - 88.00026649784942*y**5 + 5.089987671420709*y**6 - 0.04958373057889356*y**7 + 0.000053179975549796164*y**8)/exp(2*y)+fnfp**2.*(1680.5641693163564 - 5167.816781025841*y + 6095.346499693058*y**2 - 3513.597792167496*y**3 + 1057.6357920495127*y**4 - 161.79360046270696*y**5 + 10.804068943821973*y**6 - 0.17445311503190006*y**7 + 0.0012293098100301806*y**8)/exp(2*y))+0.3628*((1023.9172808953733 - 2818.7519292624065*y + 2910.803733235978*y**2 - 1423.58453377129*y**3 + 350.2944481411403*y**4 - 41.46465317175025*y**5 + 1.8946584688215464*y**6 - 0.0032791611308062274*y**7 + 1.4467092305007283*10.**-6*y**8)/exp(2*y)+fnfp*(1343.5383392964595 - 3957.182238938467*y + 4421.021422492899*y**2 - 2379.9445879828813*y**3 + 659.0907239327004*y**4 - 91.20450999360989*y**5 + 5.3832569069952445*y**6 - 0.06981140779991496*y**7 + 0.0000580033493832056*y**8)/exp(2*y)+fnfp*(1343.5383392964595 - 3957.182238938467*y + 4421.021422492899*y**2 - 2379.9445879828813*y**3 + 659.0907239327004*y**4 - 91.20450999360989*y**5 + 5.3832569069952445*y**6 - 0.06981140779991496*y**7 + 0.0000580033493832056*y**8)/exp(2*y)+fnfp**2.*(1762.9307589974521 - 5531.684770629747*y + 6655.735189995677*y**2 - 3918.7466841092028*y**3 + 1211.3549639151202*y**4 - 193.2760303755391*y**5 + 14.13989837867135*y**6 - 0.32677723313114976*y**7 + 0.002325545775708984*y**8)/exp(2*y))+0.0761*((1023.8795353642558 - 2817.91484073003*y + 2899.2621825238502*y**2 - 1405.8619599029216*y**3 + 341.22045744550223*y**4 - 39.59822338274234*y**5 + 1.7611069874302285*y**6 - 0.0024252052486447846*y**7 + 8.482468285224033*10.**-7*y**8)/exp(2*y)+fnfp*(1407.264535030404 - 4215.506457470471*y + 4779.750347018845*y**2 - 2607.898666813359*y**3 + 733.3221371436073*y**4 - 104.01043468065522*y**5 + 6.520247368979036*y**6 - 0.11277579625374286*y**7 + 0.00007632138192219469*y**8)/exp(2*y)+fnfp*(1407.264535030404 - 4215.506457470471*y + 4779.750347018845*y**2 - 2607.898666813359*y**3 + 733.3221371436073*y**4 - 104.01043468065522*y**5 + 6.520247368979036*y**6 - 0.11277579625374286*y**7 + 0.00007632138192219469*y**8)/exp(2*y)+fnfp**2.*(1934.2055419144522 - 6264.642222500086*y + 7776.543475803319*y**2 - 4729.50166633571*y**3 + 1520.1135502228458*y**4 - 256.88590408694154*y**5 + 20.98498744391021*y**6 - 0.6606610751233251*y**7 + 0.00686704994660904*y**8)/exp(2*y))+0.2084*((1023.8582398487537 - 2817.9973871293496*y + 2913.012821335188*y**2 - 1428.52955452853*y**3 + 353.0103871951601*y**4 - 42.01423863769161*y**5 + 1.927166778981209*y**6 - 0.002706581406024358*y**7 + 9.652843792604187*10.**-7*y**8)/exp(2*y)+fnfp*(1215.4882332028144 - 3492.3318580267037*y + 3796.445269874606*y**2 - 1980.472859999284*y**3 + 528.6048608714566*y**4 - 69.75099072655362*y**5 + 3.802044715339583*y**6 - 0.03371457142154313*y**7 + 0.000022300681377558363*y**8)/exp(2*y)+fnfp*(1215.4882332028144 - 3492.3318580267037*y + 3796.445269874606*y**2 - 1980.472859999284*y**3 + 528.6048608714566*y**4 - 69.75099072655362*y**5 + 3.802044715339583*y**6 - 0.03371457142154313*y**7 + 0.000022300681377558363*y**8)/exp(2*y)+fnfp**2.*(1442.9845730134923 - 4320.373300873196*y + 4929.605956909343*y**2 - 2728.024934465055*y**3 + 783.5241002313779*y**4 - 113.89567167067682*y**5 + 7.231096925855122*y**6 - 0.11319836043948425*y**7 + 0.0005152060890951321*y**8)/exp(2*y))
        return result
    elif newstr=='Argon':
        result= 0.+1.0*((323.983 - 49.7785*y + 33.7811*y**2 - 9.43017*y**3 + 0.936284*y**4 - 0.0027089*y**5 + 9.22557*10**(-3.)*y**6)/exp(2*y)+fnfp*(395.98 - 64.8966*y + 47.3349*y**2 - 14.5715*y**3 + 1.76198*y**4 - 0.0457089*y**5 + 0.63816*10**(-3.)*y**6)/exp(2*y)+fnfp*(395.98 - 64.8966*y + 47.3349*y**2 - 14.5715*y**3 + 1.76198*y**4 - 0.0457089*y**5 + 0.63816*10**(-3.)*y**6)/exp(2*y)+fnfp**2.*(483.977 - 84.2755*y + 65.8826*y**2 - 22.2028*y**3 + 3.15415*y**4 - 0.144228*y**5 + 11.2713*10**(-3.)*y**6)/exp(2*y))
        return result
    elif newstr=='Xenon':
        result= 0.+0.0192*((2915.8378133343663 - 10511.398413861774*y + 14827.309903279986*y**2 - 10595.423154860682*y**3 + 4208.919061360419*y**4 - 954.0642859262144*y**5 + 120.64715978891667*y**6 - 7.783117919721501*y**7 + 0.19785085969241503*y**8 - 7.494519613522023*10.**-10*y**9 + 7.131567058306223*10.**-19*y**10)/exp(2*y)+fnfp*(3995.6503299527008 - 15481.21474464233*y + 23702.817361512174*y**2 - 18634.15125236989*y**3 + 8270.677333593505*y**4 - 2136.147631534116*y**5 + 316.14127471510284*y**6 - 24.894313639890303*y**7 + 0.8513388680143347*y**8 - 0.005476947200494692*y**9 + 1.0373237831402439*10.**-11*y**10)/exp(2*y)+fnfp*(3995.6503299527008 - 15481.21474464233*y + 23702.817361512174*y**2 - 18634.15125236989*y**3 + 8270.677333593505*y**4 - 2136.147631534116*y**5 + 316.14127471510284*y**6 - 24.894313639890303*y**7 + 0.8513388680143347*y**8 - 0.005476947200494692*y**9 + 1.0373237831402439*10.**-11*y**10)/exp(2*y)+fnfp**2.*(5475.346223387619 - 22690.38960074352*y + 37516.479466402074*y**2 - 32239.860761045406*y**3 + 15865.613954511005*y**4 - 4624.9528756548325*y**5 + 791.6889477689501*y**6 - 74.9266636190151*y**7 + 3.329516414503511*y**8 - 0.04116962316975794*y**9 + 0.0001516138847779833*y**10)/exp(2*y))+0.2644*((2915.9616499666345 - 10511.830062367104*y + 14682.656392782003*y**2 - 10251.042123224799*y**3 + 3918.0713578471523*y**4 - 838.6428963511055*y**5 + 97.78138068360916*y**6 - 5.640801249855403*y**7 + 0.12489631415709902*y**8 + 1.0368322158463047*10.**-9*y**9 + 2.1714025073051784*10.**-18*y**10)/exp(2*y)+fnfp*(4049.608321936589 - 15794.210819857166*y + 24185.333228814685*y**2 - 18866.60966483998*y**3 + 8245.135944567613*y**4 - 2080.8338574964537*y**5 + 298.7848852902902*y**6 - 22.74112506880672*y**7 + 0.765479783945116*y**8 - 0.006526582724379428*y**9 - 2.7090361480133334*10.**-11*y**10)/exp(2*y)+fnfp*(4049.608321936589 - 15794.210819857166*y + 24185.333228814685*y**2 - 18866.60966483998*y**3 + 8245.135944567613*y**4 - 2080.8338574964537*y**5 + 298.7848852902902*y**6 - 22.74112506880672*y**7 + 0.765479783945116*y**8 - 0.006526582724379428*y**9 - 2.7090361480133334*10.**-11*y**10)/exp(2*y)+fnfp**2.*(5623.986022342139 - 23595.080480508976*y + 39347.84883230442*y**2 - 33976.162006504535*y**3 + 16764.27357203024*y**4 - 4900.870425684737*y**5 + 845.0594377564701*y**6 - 81.71404356026565*y**7 + 3.8837550724439533*y**8 - 0.06459856640908497*y**9 + 0.00034105335973491646*y**10)/exp(2*y))+0.0408*((2915.853215989028 - 10511.466618115512*y + 14771.267139297794*y**2 - 10462.208733069368*y**3 + 4096.264517961561*y**4 - 909.3865042871528*y**5 + 111.83010573647536*y**6 - 6.959774086998922*y**7 + 0.16952173759111838*y**8 + 1.3143927907686477*10.**-9*y**9 + 2.5333029251893748*10.**-18*y**10)/exp(2*y)+fnfp*(4103.52767594563 - 16035.317748483865*y + 24698.325337328148*y**2 - 19476.8511333302*y**3 + 8649.241921113862*y**4 - 2230.9085786694686*y**5 + 329.646981328735*y**6 - 26.031481074282762*y**7 + 0.9140581147706768*y**8 - 0.007604085522044571*y**9 - 2.9479279582123026*10.**-11*y**10)/exp(2*y)+fnfp*(4103.52767594563 - 16035.317748483865*y + 24698.325337328148*y**2 - 19476.8511333302*y**3 + 8649.241921113862*y**4 - 2230.9085786694686*y**5 + 329.646981328735*y**6 - 26.031481074282762*y**7 + 0.9140581147706768*y**8 - 0.007604085522044571*y**9 - 2.9479279582123026*10.**-11*y**10)/exp(2*y)+fnfp**2.*(5774.961268597378 - 24315.156662353344*y + 40790.9714374434*y**2 - 35523.436038080035*y**3 + 17711.21857045915*y**4 - 5238.054383821549*y**5 + 913.8740237774132*y**6 - 89.23816346252087*y**7 + 4.247209068927821*y**8 - 0.0679986397892301*y**9 + 0.00034108989757640674*y**10)/exp(2*y))+0.2118*((2915.9773250705875 - 10511.899809278506*y + 14641.91177688592*y**2 - 10153.170945817545*y**3 + 3836.1782385155066*y**4 - 807.0461662817808*y**5 + 91.84129112179563*y**6 - 5.128401304039986*y**7 + 0.10955339283536918*y**8 - 2.3687438289083943*10.**-9*y**9 + 1.3028415043831071*10.**-17*y**10)/exp(2*y)+fnfp*(4157.703282301202 - 16349.292165669089*y + 25195.21271186886*y**2 - 19737.79560429236*y**3 + 8646.451886144621*y**4 - 2184.7388946800047*y**5 + 314.183509519333*y**6 - 24.04770919835928*y**7 + 0.8291356630777393*y**8 - 0.008205420960585685*y**9 + 8.897782155719863*10.**-11*y**10)/exp(2*y)+fnfp*(4157.703282301202 - 16349.292165669089*y + 25195.21271186886*y**2 - 19737.79560429236*y**3 + 8646.451886144621*y**4 - 2184.7388946800047*y**5 + 314.183509519333*y**6 - 24.04770919835928*y**7 + 0.8291356630777393*y**8 - 0.008205420960585685*y**9 + 8.897782155719863*10.**-11*y**10)/exp(2*y)+fnfp**2.*(5928.199933186976 - 25252.037120073248*y + 42716.63110000194*y**2 - 37385.22739041064*y**3 + 18698.009367976905*y**4 - 5549.9898249349935*y**5 + 976.1801631414057*y**6 - 97.3377746870937*y**7 + 4.906278287213468*y**8 - 0.09555603087604632*y**9 + 0.0006148959480324583*y**10)/exp(2*y))+0.2689*((2915.992131155496 - 10511.966126675916*y + 14729.923726649919*y**2 - 10362.896499900478*y**3 + 4012.3615508721164*y**4 - 876.2421622968443*y**5 + 105.32693858795683*y**6 - 6.358069243581116*y**7 + 0.14922172065114658*y**8 - 7.250268215454429*10.**-11*y**9)/exp(2*y)+fnfp*(4211.839648715298 - 16591.259728563044*y + 25705.040944714794*y**2 - 20341.71721373778*y**3 + 9046.278949246243*y**4 - 2333.2141522182637*y**5 + 344.6916604237154*y**6 - 27.307857530806118*y**7 + 0.9792575397673371*y**8 - 0.009512536414038313*y**9 + 2.3109383226028004*10.**-12*y**10)/exp(2*y)+fnfp*(4211.839648715298 - 16591.259728563044*y + 25705.040944714794*y**2 - 20341.71721373778*y**3 + 9046.278949246243*y**4 - 2333.2141522182637*y**5 + 344.6916604237154*y**6 - 27.307857530806118*y**7 + 0.9792575397673371*y**8 - 0.009512536414038313*y**9 + 2.3109383226028004*10.**-12*y**10)/exp(2*y)+fnfp**2.*(6083.553188279929 - 25997.78827891428*y + 44205.46099633615*y**2 - 38969.633418516365*y**3 + 19660.262450228074*y**4 - 5889.718556728607*y**5 + 1044.762229408093*y**6 - 104.7422637829093*y**7 + 5.261143672153445*y**8 - 0.09901306548564826*y**9 + 0.0006064019767420125*y**10)/exp(2*y))+0.1044*((2915.959058022511 - 10522.532952260257*y + 14610.989301011008*y**2 - 10042.027240634881*y**3 + 3735.264837666257*y**4 - 767.3945526486834*y**5 + 84.54654354103812*y**6 - 4.548907692199736*y**7 + 0.09763545845437405*y**8 - 0.00027605568964819666*y**9 + 2.098540084189989*10.**-7*y**10)/exp(2*y)+fnfp*(4319.2419689131475 - 17197.609248438475*y + 26739.897982556184*y**2 - 21054.914260028785*y**3 + 9240.52619851003*y**4 - 2333.8408575766557*y**5 + 335.50588998033555*y**6 - 25.850709620516064*y**7 + 0.927637170287279*y**8 - 0.011468139045579003*y**9 + 0.00001591988925065841*y**10)/exp(2*y)+fnfp*(4319.2419689131475 - 17197.609248438475*y + 26739.897982556184*y**2 - 21054.914260028785*y**3 + 9240.52619851003*y**4 - 2333.8408575766557*y**5 + 335.50588998033555*y**6 - 25.850709620516064*y**7 + 0.927637170287279*y**8 - 0.011468139045579003*y**9 + 0.00001591988925065841*y**10)/exp(2*y)+fnfp**2.*(6397.844007683841 - 27860.38666896383*y + 48049.123174496235*y**2 - 42762.450562919534*y**3 + 21724.493722380437*y**4 - 6556.565724728468*y**5 + 1178.122225204709*y**6 - 121.5382579267657*y**7 + 6.555265845251122*y**8 - 0.1512845664867329*y**9 + 0.0012077104252741387*y**10)/exp(2*y))+0.0887*((2915.99793278501 - 10522.76711504121*y + 14611.289489985418*y**2 - 10042.068025824256*y**3 + 3735.1299683483685*y**4 - 767.2841393048069*y**5 + 84.5103688000053*y**6 - 4.544281067052663*y**7 + 0.09748974078692509*y**8 - 0.0002773343219684782*y**9 + 2.122325664012171*10.**-7*y**10)/exp(2*y)+fnfp*(4427.993932710039 - 17709.487457291187*y + 27687.87078091858*y**2 - 21947.106861531072*y**3 + 9703.994757112223*y**4 - 2470.2108512108443*y**5 + 357.8323468130645*y**6 - 27.737567695695006*y**7 + 0.996095417967297*y**8 - 0.012201443723888896*y**9 + 0.000017018129418954352*y**10)/exp(2*y)+fnfp*(4427.993932710039 - 17709.487457291187*y + 27687.87078091858*y**2 - 21947.106861531072*y**3 + 9703.994757112223*y**4 - 2470.2108512108443*y**5 + 357.8323468130645*y**6 - 27.737567695695006*y**7 + 0.996095417967297*y**8 - 0.012201443723888896*y**9 + 0.000017018129418954352*y**10)/exp(2*y)+fnfp**2.*(6723.986340206541 - 29519.93302672023*y + 51423.87123594979*y**2 - 46320.6350644163*y**3 + 23852.627467296134*y**4 - 7303.558640767209*y**5 + 1331.6795912294158*y**6 - 139.23038044890498*y**7 + 7.573355028749994*y**8 - 0.17356258781950204*y**9 + 0.0013646196426468204*y**10)/exp(2*y))
        return result
    elif newstr=='Helium':
        result= 0.+1.0*(4./exp(2*y)+fnfp*4./exp(2*y)+fnfp*4./exp(2*y)+fnfp**2.*4./exp(2*y))
        return result
    elif newstr=='Fluorine':
        result= 0.+1.0*((81.0000002653017 - 96.00000093090816*y + 36.323924754562576*y**2 - 4.66932142354541*y**3 + 0.19162408187947466*y**4)/exp(2*y)+fnfp*(89.99999737282025 - 113.33332872778523*y + 47.604235475299106*y**2 - 7.464217895543761*y**3 + 0.3731173504472172*y**4)/exp(2*y)+fnfp*(89.99999737282025 - 113.33332872778523*y + 47.604235475299106*y**2 - 7.464217895543761*y**3 + 0.3731173504472172*y**4)/exp(2*y)+fnfp**2.*(99.99999383428995 - 133.3333214685319*y + 61.49153435847994*y**2 - 11.364729745139291*y**3 + 0.7265086717666006*y**4)/exp(2*y))
        return result

def factor_SigPP(str newstr, DTYPE_t y, DTYPE_t fnfp):
    cdef DTYPE_t result
    if newstr=='Iodine':
        result= 0.+1.0*((0.1301314994348263 - 0.4885393712113938*y + 1.8336914142506733*y**2 - 2.7956116444935835*y**3 + 2.7042132067637925*y**4 - 1.5827506208650644*y**5 + 0.5283988256789192*y**6 - 0.09205030136620834*y**7 + 0.006668610564561034*y**8 - 6.284029870998687*10.**-12*y**9 + 1.3500928483894102*10.**-20*y**10)/exp(2*y)+fnfp*(0.032286773126614945 - 0.12517937397772838*y + 0.26444995227503204*y**2 - 0.29683159829976064*y**3 + 0.21415488265421448*y**4 - 0.09824074146200924*y**5 + 0.0271251818589199*y**6 - 0.004226856217858093*y**7 + 0.0003302713885829071*y**8 - 9.725513144059536*10.**-6*y**9 + 1.0243364929959174*10.**-14*y**10)/exp(2*y)+fnfp*(0.032286773126614945 - 0.12517937397772838*y + 0.26444995227503204*y**2 - 0.29683159829976064*y**3 + 0.21415488265421448*y**4 - 0.09824074146200924*y**5 + 0.0271251818589199*y**6 - 0.004226856217858093*y**7 + 0.0003302713885829071*y**8 - 9.725513144059536*10.**-6*y**9 + 1.0243364929959174*10.**-14*y**10)/exp(2*y)+fnfp**2.*(0.008010633270629355 - 0.032042713505742816*y + 0.05343325902838996*y**2 - 0.046165433465339675*y**3 + 0.02473817257053796*y**4 - 0.008580676477952178*y**5 + 0.0019029384886768109*y**6 - 0.00026203080189877244*y**7 + 0.00002137023592665378*y**8 - 9.362698896288554*10.**-7*y**9 + 1.68750591233943*10.**-8*y**10)/exp(2*y))
        return result
    elif newstr=='Sodium':
        result= 0.+1.0*((0.13636143419314364 - 0.2668173922846629*y + 0.45759754571291034*y**2 - 0.11214063736216423*y**3 + 0.008284889591556087*y**4)/exp(2*y)+fnfp*(0.010968781884541805 - 0.029995966555175287*y + 0.021719196798876232*y**2 - 0.008974983136244546*y**3 + 0.0005917961816951522*y**4)/exp(2*y)+fnfp*(0.010968781884541805 - 0.029995966555175287*y + 0.021719196798876232*y**2 - 0.008974983136244546*y**3 + 0.0005917961816951522*y**4)/exp(2*y)+fnfp**2.*(0.0008823182063356458 - 0.003099267682540582*y + 0.0039886087877625915*y**2 - 0.002032463034161716*y**3 + 0.0004093198907438072*y**4)/exp(2*y))
        return result
    elif newstr=='Germanium':
        result= 0.+0.2754*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0773*((0.0001020414890887634 - 0.0009611904947036025*y + 0.003351890331506513*y**2 - 0.0036408942270277074*y**3 + 0.0019990953485949613*y**4 - 0.00046268490801330435*y**5 + 0.00004024402096119562*y**6 - 3.451521063271299*10.**-7*y**7 + 1.2862970252393173*10.**-9*y**8)/exp(2*y)+fnfp*(0.006128838164144023 - 0.038673308339990345*y + 0.05750454541553736*y**2 - 0.05354667991696551*y**3 + 0.02578823642089163*y**4 - 0.006511801828788011*y**5 + 0.0008164037961479183*y**6 - 0.00004023739167269707*y**7 + 7.369166091336985*10.**-7*y**8)/exp(2*y)+fnfp*(0.006128838164144023 - 0.038673308339990345*y + 0.05750454541553736*y**2 - 0.05354667991696551*y**3 + 0.02578823642089163*y**4 - 0.006511801828788011*y**5 + 0.0008164037961479183*y**6 - 0.00004023739167269707*y**7 + 7.369166091336985*10.**-7*y**8)/exp(2*y)+fnfp**2.*(0.3681116139885773 - 1.1781434482523376*y + 2.2723671764773017*y**2 - 1.981633479169132*y**3 + 1.0190922627428973*y**4 - 0.2964833083669591*y**5 + 0.05660797346626959*y**6 - 0.0059902524663900825*y**7 + 0.0009510842844885312*y**8)/exp(2*y))+0.3628*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0761*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2084*(0+fnfp*0+fnfp*0+fnfp**2.*0)
        return result
    elif newstr=='Argon':
        result= 0.+1.0*(0.+fnfp*0.+fnfp*0.+fnfp**2.*0.)
        return result
    elif newstr=='Xenon':
        result= 0.+0.0192*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2644*((0.00021057497881607118 - 0.0015029518095059683*y + 0.004312384349205905*y**2 - 0.006300329530940859*y**3 + 0.004911013091760974*y**4 - 0.0019952822851312503*y**5 + 0.0004182503834761104*y**6 - 0.00004229674900398227*y**7 + 1.6267985504431177*10.**-6*y**8 + 3.3157312627630414*10.**-14*y**9 + 1.6923802788020085*10.**-22*y**10)/exp(2*y)+fnfp*(0.007209915074030221 - 0.03801024687447035*y + 0.08242988666857846*y**2 - 0.09715257309839666*y**3 + 0.06793201111894676*y**4 - 0.027154773947069992*y**5 + 0.0061382468748126745*y**6 - 0.000734194712859529*y**7 + 0.0000354171560441614*y**8 - 7.27679398302901*10.**-8*y**9 - 7.41579322268432*10.**-16*y**10)/exp(2*y)+fnfp*(0.007209915074030221 - 0.03801024687447035*y + 0.08242988666857846*y**2 - 0.09715257309839666*y**3 + 0.06793201111894676*y**4 - 0.027154773947069992*y**5 + 0.0061382468748126745*y**6 - 0.000734194712859529*y**7 + 0.0000354171560441614*y**8 - 7.27679398302901*10.**-8*y**9 - 7.41579322268432*10.**-16*y**10)/exp(2*y)+fnfp**2.*(0.246861596125969 - 0.840936668811565*y + 1.4481989381343818*y**2 - 1.467218662444814*y**3 + 0.9449024645906667*y**4 - 0.3725498316458109*y**5 + 0.08909968656835861*y**6 - 0.012071603190201034*y**7 + 0.0007557349061372443*y**8 - 3.0838576654600997*10.**-6*y**9 + 3.254996009644849*10.**-9*y**10)/exp(2*y))+0.0408*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2118*((0.000057899526342342014 - 0.00003274396425382427*y + 0.00012738803468564523*y**2 - 0.0006246059922646823*y**3 + 0.000875356584184422*y**4 - 0.0005286329242699705*y**5 + 0.00015194824903893713*y**6 - 0.000019778504522791613*y**7 + 9.381219376727716*10.**-7*y**8 - 1.0468074631557705*10.**-13*y**9 + 5.942658543290469*10.**-21*y**10)/exp(2*y)+fnfp*(0.002255238846497862 + 0.003155344330845918*y - 0.010606507639122967*y**2 - 0.0007722283565338617*y**3 + 0.019283949985641615*y**4 - 0.017692756709386057*y**5 + 0.006634251451268132*y**6 - 0.0011235712498808541*y**7 + 0.00006833274750394841*y**8 - 3.761913173886445*10.**-8*y**9 + 3.591617059489186*10.**-15*y**10)/exp(2*y)+fnfp*(0.002255238846497862 + 0.003155344330845918*y - 0.010606507639122967*y**2 - 0.0007722283565338617*y**3 + 0.019283949985641615*y**4 - 0.017692756709386057*y**5 + 0.006634251451268132*y**6 - 0.0011235712498808541*y**7 + 0.00006833274750394841*y**8 - 3.761913173886445*10.**-8*y**9 + 3.591617059489186*10.**-15*y**10)/exp(2*y)+fnfp**2.*(0.0878435900266337 + 0.2954852771783792*y - 0.23208281955257398*y**2 - 0.46510022297957004*y**3 + 1.2432433443627382*y**4 - 1.072288243652053*y**5 + 0.43810349326200776*y**6 - 0.08595095904792516*y**7 + 0.006651997841535291*y**8 - 7.675188969749176*10.**-6*y**9 + 2.2456473061521256*10.**-9*y**10)/exp(2*y))+0.2689*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.1044*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0887*(0+fnfp*0+fnfp*0+fnfp**2.*0)
        return result
    elif newstr=='Helium':
        result= 0.+1.0*(0.+fnfp*0.+fnfp*0.+fnfp**2.*0.)
        return result
    elif newstr=='Fluorine':
        result= 0.+1.0*((0.9027798376890246 - 2.371437182024702*y + 2.353098482274656*y**2 - 1.0451654136733277*y**3 + 0.1753592424939289*y**4)/exp(2*y)+fnfp*(-0.0165506084475708 + 0.05094800390862454*y - 0.051030812801549884*y**2 + 0.019928722076096975*y**3 - 0.002367342451283393*y**4)/exp(2*y)+fnfp*(-0.0165506084475708 + 0.05094800390862454*y - 0.051030812801549884*y**2 + 0.019928722076096975*y**3 - 0.002367342451283393*y**4)/exp(2*y)+fnfp**2.*(0.0003034213088830918 - 0.0010710212099164253*y + 0.0011420739816652209*y**2 - 0.00034759361344974325*y**3 + 0.000031959024240428055*y**4)/exp(2*y))
        return result

def factor_SigP(str newstr, DTYPE_t y, DTYPE_t fnfp):
    cdef DTYPE_t result
    if newstr=='Iodine':
        result= 0.+1.0*((0.26026299886965265 - 1.5935648492504129*y + 5.296116487861222*y**2 - 8.89098376362831*y**3 + 8.70123431424807*y**4 - 4.910895324409411*y**5 + 1.538749898111764*y**6 - 0.24561561565861523*y**7 + 0.01574911477796724*y**8 - 1.1816312767181886*10.**-10*y**9 + 9.233505530132098*10.**-19*y**10)/exp(2*y)+fnfp*(0.06457354625322988 - 0.45598229721010247*y + 1.280870655495619*y**2 - 1.7942481445423903*y**3 + 1.415441589743316*y**4 - 0.6510038553140445*y**5 + 0.17405133150050214*y**6 - 0.02619349716730128*y**7 + 0.0020190417180224324*y**8 - 0.00006042787192711528*y**9 + 5.349173165839139*10.**-13*y**10)/exp(2*y)+fnfp*(0.06457354625322988 - 0.45598229721010247*y + 1.280870655495619*y**2 - 1.7942481445423903*y**3 + 1.415441589743316*y**4 - 0.6510038553140445*y**5 + 0.17405133150050214*y**6 - 0.02619349716730128*y**7 + 0.0020190417180224324*y**8 - 0.00006042787192711528*y**9 + 5.349173165839139*10.**-13*y**10)/exp(2*y)+fnfp**2.*(0.016021266541258697 - 0.12816981616040662*y + 0.3703059158852227*y**2 - 0.4829421943109278*y**3 + 0.3357269065722811*y**4 - 0.13507497078227268*y**5 + 0.03271839792768596*y**6 - 0.00480082609841964*y**7 + 0.00041436873474001885*y**8 - 0.000019222229598519033*y**9 + 3.6790218076263286*10.**-7*y**10)/exp(2*y))
        return result
    elif newstr=='Sodium':
        result= 0.+1.0*((0.2727228683862874 - 0.8240740812604863*y + 1.1853286803915033*y**2 - 0.4768877964290341*y**3 + 0.05933295136542441*y**4)/exp(2*y)+fnfp*(0.02193756376908363 - 0.05775428852115918*y + 0.0359878676561226*y**2 - 0.0030041193517936875*y**3 - 0.00036315899108575327*y**4)/exp(2*y)+fnfp*(0.02193756376908363 - 0.05775428852115918*y + 0.0359878676561226*y**2 - 0.0030041193517936875*y**3 - 0.00036315899108575327*y**4)/exp(2*y)+fnfp**2.*(0.0017646364126713136 - 0.00395927796814465*y + 0.002282144914511507*y**2 + 0.00001946667743660274*y**3 + 2.3653662296072913*10.**-6*y**4)/exp(2*y))
        return result
    elif newstr=='Germanium':
        result= 0.+0.2754*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0773*((0.0002040829781775268 - 0.00046355796773334877*y + 0.0014834767140252999*y**2 - 0.0022905597916768254*y**3 + 0.0020504853066828756*y**4 - 0.0007564442244947471*y**5 + 0.00010252712595654375*y**6 - 2.050369486423927*10.**-6*y**7 + 3.0076913013917764*10.**-8*y**8)/exp(2*y)+fnfp*(0.012257676328288116 - 0.053136185549787496*y + 0.07236734535708003*y**2 - 0.06691527728049694*y**3 + 0.03840298426523023*y**4 - 0.01191032750240465*y**5 + 0.0018414704848249612*y**6 - 0.00013920812236234846*y**7 + 4.9748876393917326*10.**-6*y**8)/exp(2*y)+fnfp*(0.012257676328288116 - 0.053136185549787496*y + 0.07236734535708003*y**2 - 0.06691527728049694*y**3 + 0.03840298426523023*y**4 - 0.01191032750240465*y**5 + 0.0018414704848249612*y**6 - 0.00013920812236234846*y**7 + 4.9748876393917326*10.**-6*y**8)/exp(2*y)+fnfp**2.*(0.7362232279771543 - 4.710682844812246*y + 11.67256095192697*y**2 - 12.519888891567701*y**3 + 6.9129948412528535*y**4 - 2.071197222577642*y**5 + 0.34798239918820567*y**6 - 0.030886984314424805*y**7 + 0.001911494404542329*y**8)/exp(2*y))+0.3628*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0761*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2084*(0+fnfp*0+fnfp*0+fnfp**2.*0)
        return result
    elif newstr=='Argon':
        result= 0.+1.0*(0.+fnfp*0.+fnfp*0.+fnfp**2.*0.)
        return result
    elif newstr=='Xenon':
        result= 0.+0.0192*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2644*((0.00042114995763214237 - 0.0018662467895073334*y + 0.006480861151358198*y**2 - 0.011980916012423966*y**3 + 0.016681840050461413*y**4 - 0.012071024142885406*y**5 + 0.004135627170825251*y**6 - 0.0006269309478645078*y**7 + 0.00003412639845327103*y**8 + 1.2886172213407675*10.**-12*y**9 + 1.2161750026554165*10.**-20*y**10)/exp(2*y)+fnfp*(0.014419830148060463 - 0.07967917726745832*y + 0.23062698253168587*y**2 - 0.4144223941398706*y**3 + 0.42773875891565527*y**4 - 0.2378425671980739*y**5 + 0.06973088443550536*y**6 - 0.010126866769259038*y**7 + 0.0005849329477850766*y**8 - 2.828037485857994*10.**-6*y**9 - 5.3393711194231774*10.**-14*y**10)/exp(2*y)+fnfp*(0.014419830148060463 - 0.07967917726745832*y + 0.23062698253168587*y**2 - 0.4144223941398706*y**3 + 0.42773875891565527*y**4 - 0.2378425671980739*y**5 + 0.06973088443550536*y**6 - 0.010126866769259038*y**7 + 0.0005849329477850766*y**8 - 2.828037485857994*10.**-6*y**9 - 5.3393711194231774*10.**-14*y**10)/exp(2*y)+fnfp**2.*(0.49372319225193834 - 3.268458319125825*y + 8.786594307784966*y**2 - 12.367336994084656*y**3 + 9.843951580101947*y**4 - 4.510714776059415*y**5 + 1.1774028689185023*y**6 - 0.16416972682497216*y**7 + 0.009973986654026882*y**8 - 0.00009264115651800897*y**9 + 2.3435971269442917*10.**-7*y**10)/exp(2*y))+0.0408*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2118*((0.00011579905268467313 - 0.0008936458227964391*y + 0.0015467587998673437*y**2 + 0.0014962463502794228*y**3 - 0.0006925490042573771*y**4 - 0.0011863162691919348*y**5 + 0.000800760309108084*y**6 - 0.00015920044853522428*y**7 + 0.000010129115280612893*y**8 - 3.386962758236039*10.**-12*y**9 + 2.9816037415528175*10.**-19*y**10)/exp(2*y)+fnfp*(0.004510477692995767 - 0.03855486215677395*y + 0.09475525968415777*y**2 - 0.03759682522024164*y**3 - 0.0774150505975104*y**4 + 0.08734567166390032*y**5 - 0.03463079381150081*y**6 + 0.005862334594625254*y**7 - 0.0003520027998722947*y**8 - 9.397125903039345*10.**-7*y**9 + 1.60940178780241*10.**-13*y**10)/exp(2*y)+fnfp*(0.004510477692995767 - 0.03855486215677395*y + 0.09475525968415777*y**2 - 0.03759682522024164*y**3 - 0.0774150505975104*y**4 + 0.08734567166390032*y**5 - 0.03463079381150081*y**6 + 0.005862334594625254*y**7 - 0.0003520027998722947*y**8 - 9.397125903039345*10.**-7*y**9 + 1.60940178780241*10.**-13*y**10)/exp(2*y)+fnfp**2.*(0.17568718005326747 - 1.6476782187103218*y + 5.753974870960492*y**2 - 9.70476961101359*y**3 + 9.11141031210273*y**4 - 4.853807988727512*y**5 + 1.4313395001314198*y**6 - 0.21435576007669843*y**7 + 0.01241877484260487*y**8 + 0.00006573533612714645*y**9 + 8.816246344320684*10.**-8*y**10)/exp(2*y))+0.2689*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.1044*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0887*(0+fnfp*0+fnfp*0+fnfp**2.*0)
        return result
    elif newstr=='Helium':
        result= 0.+1.0*(0.+fnfp*0.+fnfp*0.+fnfp**2.*0.)
        return result
    elif newstr=='Fluorine':
        result= 0.+1.0*((1.8055596753780483 - 4.850801519487493*y + 4.879221847956488*y**2 - 2.1777392937517477*y**3 + 0.36391219684920834*y**4)/exp(2*y)+fnfp*(-0.03310121689514143 + 0.08145686367194169*y - 0.051134424513859904*y**2 - 0.0014163445923150292*y**3 + 0.006023735506451014*y**4)/exp(2*y)+fnfp*(-0.03310121689514143 + 0.08145686367194169*y - 0.051134424513859904*y**2 - 0.0014163445923150292*y**3 + 0.006023735506451014*y**4)/exp(2*y)+fnfp**2.*(0.0006068426177661836 - 0.0013563492611476115*y + 0.0002659248449639339*y**2 + 0.0005497953813424535*y**3 + 0.0000997091874519388*y**4)/exp(2*y))
        return result

def factor_PhiPP(str newstr, DTYPE_t y, DTYPE_t fnfp):
    cdef DTYPE_t result
    if newstr=='Iodine':
        result= 0.+1.0*((201.19539553235543 - 482.86803133983614*y + 442.6790271881663*y**2 - 197.11462955278412*y**3 + 45.35095793943659*y**4 - 5.157901161388774*y**5 + 0.22897388184422526*y**6 - 1.921153574027405*10.**-10*y**7 + 5.109182370129832*10.**-19*y**8)/exp(2*y)+fnfp*(94.56362577682015 - 264.77809250656907*y + 282.3185712069177*y**2 - 148.0499269938176*y**3 + 41.66247225936242*y**4 - 6.345878746535169*y**5 + 0.4877854002516878*y**6 - 0.014630369608615612*y**7 + 8.860354426565626*10.**-12*y**8)/exp(2*y)+fnfp*(94.56362577682015 - 264.77809250656907*y + 282.3185712069177*y**2 - 148.0499269938176*y**3 + 41.66247225936242*y**4 - 6.345878746535169*y**5 + 0.4877854002516878*y**6 - 0.014630369608615612*y**7 + 8.860354426565626*10.**-12*y**8)/exp(2*y)+fnfp**2.*(44.447399038044225 - 142.23242927003096*y + 174.8237521918156*y**2 - 106.69341765416755*y**3 + 35.83978858398685*y**4 - 6.872752879859579*y**5 + 0.7436553452420294*y**6 - 0.04195065283634805*y**7 + 0.0009546858374979581*y**8)/exp(2*y))
        return result
    elif newstr=='Sodium':
        result= 0.+1.0*((1.4758335893483934 - 1.1912725951428864*y + 0.2746972111453533*y**2)/exp(2*y)+fnfp*(1.8935641665784781 - 1.5255616971696417*y + 0.33363546535908195*y**2)/exp(2*y)+fnfp*(1.8935641665784781 - 1.5255616971696417*y + 0.33363546535908195*y**2)/exp(2*y)+fnfp**2.*(2.4295330547322047 - 1.9538253508311707*y + 0.413082491076519*y**2)/exp(2*y))
        return result
    elif newstr=='Germanium':
        result= 0.+0.2754*((67.76204087688788 - 109.54054891115089*y + 63.663664212974105*y**2 - 15.747088246862976*y**3 + 1.4452611355398455*y**4 - 0.010187971963830618*y**5 + 0.000018698814353374417*y**6)/exp(2*y)+fnfp*(6.927913194919476 - 12.979715467340235*y + 8.791388705551839*y**2 - 2.6595129000923294*y**3 + 0.3607650958193764*y**4 - 0.017661628146033705*y**5 + 0.00006129354159108629*y**6)/exp(2*y)+fnfp*(6.927913194919476 - 12.979715467340235*y + 8.791388705551839*y**2 - 2.6595129000923294*y**3 + 0.3607650958193764*y**4 - 0.017661628146033705*y**5 + 0.00006129354159108629*y**6)/exp(2*y)+fnfp**2.*(0.7083018842885744 - 1.5090588415272774*y + 1.178960093971856*y**2 - 0.423531421066822*y**3 + 0.0750996792679957*y**4 - 0.006318954125431346*y**5 + 0.00020091638805431802*y**6)/exp(2*y))+0.0773*((51.12703142215787 - 82.75192053825575*y + 47.29432623632093*y**2 - 11.196436586415182*y**3 + 0.9698812971367006*y**4 - 0.007268755055600689*y**5 + 0.000014951475599698164*y**6)/exp(2*y)+fnfp*(17.696046730348776 - 34.135704478309755*y + 23.579005348752673*y**2 - 7.2147063379175576*y**3 + 0.9871634335776637*y**4 - 0.04937243685996986*y**5 + 0.00021271990219918523*y**6)/exp(2*y)+fnfp*(17.696046730348776 - 34.135704478309755*y + 23.579005348752673*y**2 - 7.2147063379175576*y**3 + 0.9871634335776637*y**4 - 0.04937243685996986*y**5 + 0.00021271990219918523*y**6)/exp(2*y)+fnfp**2.*(6.562409922883522 - 15.258231344470975*y + 13.34015334717081*y**2 - 5.471274648489003*y**3 + 1.138043025525534*y**4 - 0.11578232342121642*y**5 + 0.004917239240120723*y**6)/exp(2*y))+0.3628*((35.61952240709941 - 57.44348969021864*y + 31.83723297857755*y**2 - 7.025802309859368*y**3 + 0.5516488811177607*y**4 - 0.0034976085292767792*y**5 + 5.786836922002913*10.**-6*y**6)/exp(2*y)+fnfp*(26.425056821788708 - 51.51387916179754*y + 35.85941573445437*y**2 - 10.945414222498396*y**3 + 1.4853857734068172*y**4 - 0.07345434071205986*y**5 + 0.00023201339753282137*y**6)/exp(2*y)+fnfp*(26.425056821788708 - 51.51387916179754*y + 35.85941573445437*y**2 - 10.945414222498396*y**3 + 1.4853857734068172*y**4 - 0.07345434071205986*y**5 + 0.00023201339753282137*y**6)/exp(2*y)+fnfp**2.*(19.603958190511435 - 44.81796750313002*y + 37.906676266079145*y**2 - 14.904080474201491*y**3 + 2.902881061524425*y**4 - 0.2677433913875082*y**5 + 0.009302183102835943*y**6)/exp(2*y))+0.0761*((30.70975765393245 - 49.45715822231505*y + 27.106522834180574*y**2 - 5.813438411431673*y**3 + 0.4377752547473203*y**4 - 0.0023913073483589546*y**5 + 3.392987314089613*10.**-6*y**6)/exp(2*y)+fnfp*(39.27879559561765 - 77.5172214959396*y + 54.400111405859086*y**2 - 16.652367943499634*y**3 + 2.2597575349648937*y**4 - 0.11185013573310039*y**5 + 0.00030528552768877877*y**6)/exp(2*y)+fnfp*(39.27879559561765 - 77.5172214959396*y + 54.400111405859086*y**2 - 16.652367943499634*y**3 + 2.2597575349648937*y**4 - 0.11185013573310039*y**5 + 0.00030528552768877877*y**6)/exp(2*y)+fnfp**2.*(50.238878496807395 - 117.38594861130672*y + 101.4363133519398*y**2 - 40.746774249931015*y**3 + 8.120190831548486*y**4 - 0.7685108082648426*y**5 + 0.027468199786436182*y**6)/exp(2*y))+0.2084*((35.77488959010669 - 57.61003983618147*y + 31.6044605280272*y**2 - 6.796148747691922*y**3 + 0.5133489243522649*y**4 - 0.002763355631167805*y**5 + 3.861137517041675*10.**-6*y**6)/exp(2*y)+fnfp*(25.38317270896731 - 45.02093151703438*y + 28.579181025585353*y**2 - 7.841060862001033*y**3 + 0.9087248101134204*y**4 - 0.033826431316793755*y**5 + 0.00008920272551023353*y**6)/exp(2*y)+fnfp*(25.38317270896731 - 45.02093151703438*y + 28.579181025585353*y**2 - 7.841060862001033*y**3 + 0.9087248101134204*y**4 - 0.033826431316793755*y**5 + 0.00008920272551023353*y**6)/exp(2*y)+fnfp**2.*(18.00999148160729 - 34.884575410999595*y + 25.125081214229414*y**2 - 8.358404842458382*y**3 + 1.3139693154183705*y**4 - 0.0880645001460778*y**5 + 0.0020608243563805285*y**6)/exp(2*y))
        return result
    elif newstr=='Argon':
        result= 0.+1.0*((2.93116 - 2.43478*y + 0.531305*y**2 - 0.0106656*y**3 + 56.1717*10**(-6)*y**4)/exp(2*y)+fnfp*(3.7131 - 4.46924*y + 1.64393*y**2 - 0.183918*y**3 + 0.00180441*y**4)/exp(2*y)+fnfp*(3.7131 - 4.46924*y + 1.64393*y**2 - 0.183918*y**3 + 0.00180441*y**4)/exp(2*y)+fnfp**2.*(4.70364 - 7.41587*y + 3.96671*y**2 - 0.822759*y**3 + 0.0578972*y**4)/exp(2*y))
        return result
    elif newstr=='Xenon':
        result= 0.+0.0192*((184.5965664533284 - 443.0317992045055*y + 407.41409665017346*y**2 - 182.62699353494824*y**3 + 42.40823271894445*y**4 - 4.875754940448595*y**5 + 0.21888277926184627*y**6 - 1.9707004963339603*10.**-9*y**7 + 4.427958054112521*10.**-18*y**8)/exp(2*y)+fnfp*(90.59263374541611 - 253.65203273727533*y + 270.78766845997575*y**2 - 142.4465140706084*y**3 + 40.273485661296824*y**4 - 6.169812264163249*y**5 + 0.47725805181880876*y**6 - 0.014401751568965396*y**7 + 6.483273636643426*10.**-11*y**8)/exp(2*y)+fnfp*(90.59263374541611 - 253.65203273727533*y + 270.78766845997575*y**2 - 142.4465140706084*y**3 + 40.273485661296824*y**4 - 6.169812264163249*y**5 + 0.47725805181880876*y**6 - 0.014401751568965396*y**7 + 6.483273636643426*10.**-11*y**8)/exp(2*y)+fnfp**2.*(44.459252122688255 - 142.26239115089314*y + 174.77031844482028*y**2 - 106.57252985226827*y**3 + 35.76078002778539*y**4 - 6.849208776037985*y**5 + 0.7401370236051735*y**6 - 0.04169584396702692*y**7 + 0.0009475867798623955*y**8)/exp(2*y))+0.2644*((126.55181350701243 - 303.72433081972724*y + 280.795503431789*y**2 - 127.31946153015762*y**3 + 30.045912596740113*y**4 - 3.5227403287718566*y**5 + 0.1616665218485365*y**6 + 2.9490608067028314*10.**-9*y**7 + 1.345418024134189*10.**-17*y**8)/exp(2*y)+fnfp*(120.67783338014236 - 334.61808951353026*y + 357.9586406194227*y**2 - 190.42409167409485*y**3 + 54.53321656229611*y**4 - 8.409759230085623*y**5 + 0.6439912716820425*y**6 - 0.01856355593923448*y**7 - 1.6931475950629246*10.**-10*y**8)/exp(2*y)+fnfp*(120.67783338014236 - 334.61808951353026*y + 357.9586406194227*y**2 - 190.42409167409485*y**3 + 54.53321656229611*y**4 - 8.409759230085623*y**5 + 0.6439912716820425*y**6 - 0.01856355593923448*y**7 - 1.6931475950629246*10.**-10*y**8)/exp(2*y)+fnfp**2.*(115.07649764749078 - 361.9895961505939*y + 443.3488522173191*y**2 - 273.14064880105565*y**3 + 92.762455445946*y**4 - 17.80877133305608*y**5 + 1.889935899217871*y**6 - 0.1014466283863448*y**7 + 0.0021315834983432276*y**8)/exp(2*y))+0.0408*((152.12311152965847 - 365.0951748906652*y + 333.7813766430343*y**2 - 147.70991275372154*y**3 + 33.67882566173829*y**4 - 3.7861181638408605*y**5 + 0.16568054292753542*y**6 + 3.248540199077005*10.**-9*y**7 + 1.6008771426406807*10.**-17*y**8)/exp(2*y)+fnfp*(123.36281055958943 - 345.40095805792276*y + 367.9347731472202*y**2 - 192.51712868335724*y**3 + 54.01081484779121*y**4 - 8.199140368727006*y**5 + 0.6282250684662293*y**6 - 0.018793607240768714*y**7 - 1.842454973696417*10.**-10*y**8)/exp(2*y)+fnfp*(123.36281055958943 - 345.40095805792276*y + 367.9347731472202*y**2 - 192.51712868335724*y**3 + 54.01081484779121*y**4 - 8.199140368727006*y**5 + 0.6282250684662293*y**6 - 0.018793607240768714*y**7 - 1.842454973696417*10.**-10*y**8)/exp(2*y)+fnfp**2.*(100.03991422561799 - 320.10373336504847*y + 393.24050012095023*y**2 - 239.78732173152886*y**3 + 80.45969730479689*y**4 - 15.409980535768362*y**5 + 1.6651896831302653*y**6 - 0.09380667699503653*y**7 + 0.0021318118598525433*y**8)/exp(2*y))+0.2118*((104.80304812570196 - 251.65753575609847*y + 231.64108325098005*y**2 - 103.68830018882895*y**3 + 23.995224239395778*y**4 - 2.746901259273159*y**5 + 0.12294864253047778*y**6 - 6.328805980750593*10.**-9*y**7 + 8.17469179220773*10.**-17*y**8)/exp(2*y)+fnfp*(145.17947905499366 - 402.5253441596589*y + 429.1014697376018*y**2 - 226.7892917513154*y**3 + 64.42489366105993*y**4 - 9.852363945631652*y**5 + 0.7491488821786452*y**6 - 0.021594180376651947*y**7 + 5.561113850039167*10.**-10*y**8)/exp(2*y)+fnfp*(145.17947905499366 - 402.5253441596589*y + 429.1014697376018*y**2 - 226.7892917513154*y**3 + 64.42489366105993*y**4 - 9.852363945631652*y**5 + 0.7491488821786452*y**6 - 0.021594180376651947*y**7 + 5.561113850039167*10.**-10*y**8)/exp(2*y)+fnfp**2.*(201.93538074414508 - 636.9128198872635*y + 780.901135694559*y**2 - 480.80210074235686*y**3 + 163.10684358815936*y**4 - 31.31169807784178*y**5 + 3.3324350350047696*y**6 - 0.18020746453565276*y**7 + 0.0038430996752028645*y**8)/exp(2*y))+0.2689*((132.21157508964845 - 317.30777092806636*y + 289.30585374854655*y**2 - 127.25690536339835*y**3 + 28.76506965489721*y**4 - 3.1991220011955703*y**5 + 0.13827776939199374*y**6 - 1.7448346640562549*10.**-10*y**7)/exp(2*y)+fnfp*(153.31558722397173 - 429.2768560253798*y + 456.83830289225483*y**2 - 238.44821454050046*y**3 + 66.65660403583462*y**4 - 10.075319186422087*y**5 + 0.7684691459847215*y**6 - 0.022892672654510685*y**7 + 1.4443364612064673*10.**-11*y**8)/exp(2*y)+fnfp*(153.31558722397173 - 429.2768560253798*y + 456.83830289225483*y**2 - 238.44821454050046*y**3 + 66.65660403583462*y**4 - 10.075319186422087*y**5 + 0.7684691459847215*y**6 - 0.022892672654510685*y**7 + 1.4443364612064673*10.**-11*y**8)/exp(2*y)+fnfp**2.*(177.78828570715416 - 568.9067832413468*y + 698.9232929557614*y**2 - 426.2050049025214*y**3 + 143.01817633931893*y**4 - 27.392688832108227*y**5 + 2.960163175748275*y**6 - 0.16676515086736576*y**7 + 0.0037900123546375807*y**8)/exp(2*y))+0.1044*((80.40290321944379 - 194.7460683106391*y + 177.08724364207418*y**2 - 76.628578316559*y**3 + 16.93399096339257*y**4 - 1.856802283446885*y**5 + 0.08464643560318348*y**6 - 0.0006359575247647044*y**7 + 1.311587552619339*10.**-6*y**8)/exp(2*y)+fnfp*(175.8848885550847 - 491.55360341711724*y + 522.5185673057532*y**2 - 271.66306806581304*y**3 + 75.35203819011879*y**4 - 11.272068195876328*y**5 + 0.8543370256842875*y**6 - 0.0264006689361007*y**7 + 0.0000994993078166165*y**8)/exp(2*y)+fnfp*(175.8848885550847 - 491.55360341711724*y + 522.5185673057532*y**2 - 271.66306806581304*y**3 + 75.35203819011879*y**4 - 11.272068195876328*y**5 + 0.8543370256842875*y**6 - 0.0264006689361007*y**7 + 0.0000994993078166165*y**8)/exp(2*y)+fnfp**2.*(384.75593272549247 - 1218.662416788978*y + 1492.0618325573566*y**2 - 912.7603503990939*y**3 + 307.51021616066873*y**4 - 58.85195179945202*y**5 + 6.291890898247614*y**6 - 0.34566372626712244*y**7 + 0.0075481901579633704*y**8)/exp(2*y))+0.0887*((81.2978082321318 - 196.91387201459366*y + 179.36874785297627*y**2 - 77.92616098832887*y**3 + 17.320381325779845*y**4 - 1.9125686374599953*y**5 + 0.08777798354669702*y**6 - 0.0006519055992443087*y**7 + 1.3264535400065424*10.**-6*y**8)/exp(2*y)+fnfp*(180.3303989023217 - 506.9204201206843*y + 539.7716020209101*y**2 - 280.4373097609933*y**3 + 77.8280292746573*y**4 - 11.701453852430861*y**5 + 0.8987536475735264*y**6 - 0.028476919694000312*y**7 + 0.00010636330886846375*y**8)/exp(2*y)+fnfp*(180.3303989023217 - 506.9204201206843*y + 539.7716020209101*y**2 - 280.4373097609933*y**3 + 77.8280292746573*y**4 - 11.701453852430861*y**5 + 0.8987536475735264*y**6 - 0.028476919694000312*y**7 + 0.00010636330886846375*y**8)/exp(2*y)+fnfp**2.*(399.999132515577 - 1279.9969325242105*y + 1572.5672812199255*y**2 - 958.9813540198994*y**3 + 321.80644865554416*y**4 - 61.63821490392827*y**5 + 6.661053423026268*y**6 - 0.37527051140926687*y**7 + 0.008528872766542626*y**8)/exp(2*y))
        return result
    elif newstr=='Helium':
        result= 0.+1.0*(0.+fnfp*0.+fnfp*0.+fnfp**2.*0.)
        return result
    elif newstr=='Fluorine':
        result= 0.+1.0*((0.03920992927221995 - 0.031367945265725415*y + 0.006273589422735007*y**2)/exp(2*y)+fnfp*(0.10001964083357587 - 0.08001571594777979*y + 0.016003143845739806*y**2)/exp(2*y)+fnfp*(0.10001964083357587 - 0.08001571594777979*y + 0.016003143845739806*y**2)/exp(2*y)+fnfp**2.*(0.2551376332006103 - 0.20411011127437687*y + 0.040822023197653136*y**2)/exp(2*y))
        return result

def factor_Delta(str newstr, DTYPE_t y, DTYPE_t fnfp):
    cdef DTYPE_t result
    if newstr=='Iodine':
        result= 0.+1.0*((0.5358168796402408 - 1.2859608404378042*y + 1.6442979109260578*y**2 - 1.193165967531386*y**3 + 0.5109282275890425*y**4 - 0.11149861262241144*y**5 + 0.009686141351684741*y**6 - 4.2572159862948373*10.**-10*y**7 + 6.762570553796846*10.**-18*y**8)/exp(2*y)+fnfp*(0.2316331442462167 - 0.6485716130894682*y + 0.7910001684059155*y**2 - 0.535610249369137*y**3 + 0.20066367315301248*y**4 - 0.04003244623507293*y**5 + 0.0038825115309283607*y**6 - 0.00013968874441643782*y**7 + 3.882466452888516*10.**-12*y**8)/exp(2*y)+fnfp*(0.2316331442462167 - 0.6485716130894682*y + 0.7910001684059155*y**2 - 0.535610249369137*y**3 + 0.20066367315301248*y**4 - 0.04003244623507293*y**5 + 0.0038825115309283607*y**6 - 0.00013968874441643782*y**7 + 3.882466452888516*10.**-12*y**8)/exp(2*y)+fnfp**2.*(0.10013479521103001 - 0.3204302535712248*y + 0.39777733447072056*y**2 - 0.2455432702093794*y**3 + 0.08393253830256202*y**4 - 0.016484721725006625*y**5 + 0.0018367791757589514*y**6 - 0.00010709973893739657*y**7 + 2.526007578055865*10.**-6*y**8)/exp(2*y))
        return result
    elif newstr=='Sodium':
        result= 0.+1.0*((0.23090254120839 - 0.18472203296671197*y + 0.050233749288494*y**2)/exp(2*y)+fnfp*(0.08120324666840396 - 0.06496259733472315*y + 0.013845183660499496*y**2)/exp(2*y)+fnfp*(0.08120324666840396 - 0.06496259733472315*y + 0.013845183660499496*y**2)/exp(2*y)+fnfp**2.*(0.028557361192220906 - 0.022845888953776712*y + 0.0046238860064773835*y**2)/exp(2*y))
        return result
    elif newstr=='Germanium':
        result= 0.+0.2754*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0773*((0.006859596871981775 - 0.01190412825626745*y + 0.00887032542980166*y**2 - 0.003133826952143597*y**3 + 0.00047718978895562386*y**4 - 0.000015339830283200638*y**5 + 1.3982227242477305*10.**-7*y**6)/exp(2*y)+fnfp*(0.14325641900759756 - 0.29572329009066856*y + 0.24830300906171637*y**2 - 0.09937721026655844*y**3 + 0.018416840183809235*y**4 - 0.0013150317980278024*y**5 + 0.000019705204888627384*y**6)/exp(2*y)+fnfp*(0.14325641900759756 - 0.29572329009066856*y + 0.24830300906171637*y**2 - 0.09937721026655844*y**3 + 0.018416840183809235*y**4 - 0.0013150317980278024*y**5 + 0.000019705204888627384*y**6)/exp(2*y)+fnfp**2.*(2.99177954184224 - 7.159894764531308*y + 6.939352949965737*y**2 - 3.140120815976457*y**3 + 0.7206185532891131*y**4 - 0.07990549803801214*y**5 + 0.00357837249697836*y**6)/exp(2*y))+0.3628*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0761*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2084*(0+fnfp*0+fnfp*0+fnfp**2.*0)
        return result
    elif newstr=='Argon':
        result= 0.+1.0*(0.+fnfp*0.+fnfp*0.+fnfp**2.*0.)
        return result
    elif newstr=='Xenon':
        result= 0.+0.0192*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2644*((0.03752175083262122 - 0.0900521919737259*y + 0.09060847594465242*y**2 - 0.04820912110953526*y**3 + 0.014093920837777808*y**4 - 0.0021039300211895483*y**5 + 0.00012414390765326974*y**6 + 6.65646334349952*10.**-12*y**7 + 8.914458822882779*10.**-20*y**8)/exp(2*y)+fnfp*(-0.004134863588535703 - 0.01207661707925625*y + 0.012216194702162375*y**2 + 0.0005615386656040098*y**3 - 0.003200214263969084*y**4 + 0.0006234525767267468*y**5 + 0.00005643338756286368*y**6 - 0.000014608527804070167*y**7 - 3.9164657958034467*10.**-13*y**8)/exp(2*y)+fnfp*(-0.004134863588535703 - 0.01207661707925625*y + 0.012216194702162375*y**2 + 0.0005615386656040098*y**3 - 0.003200214263969084*y**4 + 0.0006234525767267468*y**5 + 0.00005643338756286368*y**6 - 0.000014608527804070167*y**7 - 3.9164657958034467*10.**-13*y**8)/exp(2*y)+fnfp**2.*(0.0004556582919615322 + 0.0037552447133423605*y + 0.00910676046867966*y**2 + 0.005385922572246485*y**3 - 0.00009016586579809823*y**4 - 0.0006185459439798357*y**5 - 0.00004758384767839066*y**6 + 0.000015852024777725468*y**7 + 1.7190447675936854*10.**-6*y**8)/exp(2*y))+0.0408*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2118*((0.02235854394040302 - 0.053660542063237344*y + 0.0525156199810284*y**2 - 0.02637188627684231*y**3 + 0.007118874724335057*y**4 - 0.000976842546813781*y**5 + 0.000053501020195659064*y**6 - 2.146095940424723*10.**-11*y**7 + 2.1588873389017842*10.**-18*y**8)/exp(2*y)+fnfp*(0.11185590332104402 - 0.27796218113913174*y + 0.3100921019287054*y**2 - 0.18740194968964355*y**3 + 0.06198442993975245*y**4 - 0.010454074186649441*y**5 + 0.0007310688100336155*y**6 - 5.79922514976715*10.**-6*y**7 + 1.1593146252904128*10.**-12*y**8)/exp(2*y)+fnfp*(0.11185590332104402 - 0.27796218113913174*y + 0.3100921019287054*y**2 - 0.18740194968964355*y**3 + 0.06198442993975245*y**4 - 0.010454074186649441*y**5 + 0.0007310688100336155*y**6 - 5.79922514976715*10.**-6*y**7 + 1.1593146252904128*10.**-12*y**8)/exp(2*y)+fnfp**2.*(0.5595956132526756 - 1.4381624252085574*y + 1.8040637346965507*y**2 - 1.264821108225372*y**3 + 0.5133804522467341*y**4 - 0.1079549899745189*y**5 + 0.009676566758468844*y**6 - 0.0001482560433580662*y**7 + 6.30722031636425*10.**-7*y**8)/exp(2*y))+0.2689*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.1044*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0887*(0+fnfp*0+fnfp*0+fnfp**2.*0)
        return result
    elif newstr=='Helium':
        result= 0.+1.0*(0.+fnfp*0.+fnfp*0.+fnfp**2.*0.)
        return result
    elif newstr=='Fluorine':
        result= 0.+1.0*((0.004010983175476323*(2.5 - 1.*y)**2)/exp(2*y)+fnfp*(-0.003408462985827271*(2.5 - 1.*y)**2)/exp(2*y)+fnfp*(-0.003408462985827271*(2.5 - 1.*y)**2)/exp(2*y)+fnfp**2.*(0.0028964519215104686*(2.5 - 1.*y)**2)/exp(2*y))
        return result

def factor_MPhiPP(str newstr, DTYPE_t y, DTYPE_t fnfp):
    cdef DTYPE_t result
    if newstr=='Iodine':
        result= 0.+1.0*((-751.7694297490033 + 2244.90010890977*y - 2569.2447408567596*y**2 + 1457.2658236538393*y**3 - 444.15351653142176*y**4 + 72.92240614405634*y**5 - 5.958708397839527*y**6 + 0.18487382661126628*y**7 - 1.5339704330363046*10.**-10*y**8 + 1.9869042550504898*10.**-19*y**9)/exp(2*y)+fnfp*(-353.34035385406514 + 1196.480896731926*y - 1568.0594186003239*y**2 + 1028.3496945967802*y**3 - 371.62276668953314*y**4 + 76.29855993798452*y**5 - 8.74486280554413*y**6 + 0.5147587560392056*y**7 - 0.012040445858023595*y**8 + 3.5441417564340775*10.**-12*y**9)/exp(2*y)+fnfp*(-1049.6366977167784 + 3434.4836264105334*y - 4351.639518933412*y**2 + 2781.31668675437*y**3 - 976.8756362243794*y**4 + 190.88500817583372*y**5 - 19.587077064188417*y**6 + 0.8641332674651925*y**7 - 0.005852148172475791*y**8 + 3.5441417564340775*10.**-12*y**9)/exp(2*y)+fnfp**2.*(-493.3414255927989 + 1811.5816983161365*y - 2604.985654130309*y**2 + 1905.7096942193289*y**3 - 781.7666175320173*y**4 + 186.0719985828837*y**5 - 25.408803187849458*y**6 + 1.8588662694282123*y**7 - 0.05992248216799137*y**8 + 0.0003818743349991832*y**9)/exp(2*y))
        return result
    elif newstr=='Sodium':
        result= 0.+1.0*((-13.359517316814658 + 15.09488471699559*y - 5.341769982912086*y**2 + 0.5826327485711856*y**3)/exp(2*y)+fnfp*(-17.141128550727004 + 19.36659640915117*y - 6.736160563406105*y**2 + 0.6975276055494178*y**3)/exp(2*y)+fnfp*(-14.574019782451185 + 17.202644351109747*y - 6.318853464022539*y**2 + 0.7069976115301921*y**3)/exp(2*y)+fnfp**2.*(-18.69941410812874 + 22.070905099021264*y - 7.981059463159473*y**2 + 0.857182019422271*y**3)/exp(2*y))
        return result
    elif newstr=='Germanium':
        result= 0.+0.2754*((-263.41438019780986 + 575.8050807646712*y - 462.45047419518664*y**2 + 171.40086106163574*y**3 - 29.60091364296539*y**4 + 1.95718960241039*y**5 - 0.009425119173598279*y**6 + 9.34940717668719*10.**-6*y**7)/exp(2*y)+fnfp*(-26.931183545954546 + 65.7907382298804*y - 60.09396417676683*y**2 + 25.93359128218442*y**3 - 5.611750447255845*y**4 + 0.5828067435763283*y**5 - 0.02302799724217578*y**6 + 0.000030646770795543126*y**7)/exp(2*y)+fnfp*(-329.25502768959063 + 762.300005033728*y - 647.3388951315683*y**2 + 254.58369225925063*y**3 - 46.94025054772952*y**4 + 3.359552648401409*y**5 - 0.020123838053541693*y**6 + 0.000030646770795543126*y**7)/exp(2*y)+fnfp**2.*(-33.662655689024646 + 86.58769690304376*y - 83.31806188033053*y**2 + 37.98670911260887*y**3 - 8.694936244146325*y**4 + 0.9562831180961674*y**5 - 0.04017730193429749*y**6 + 0.00010045819402715894*y**7)/exp(2*y))+0.0773*((-228.7774885446678 + 499.8921085598342*y - 395.97230098258655*y**2 + 142.18987395158072*y**3 - 23.39130838806493*y**4 + 1.4584373455362478*y**5 - 0.007632335899700071*y**6 + 7.475737799849423*10.**-6*y**7)/exp(2*y)+fnfp*(-79.51667250199802 + 200.77132520437786*y - 189.9555350419492*y**2 + 85.15718343196717*y**3 - 19.2584989116576*y**4 + 2.107521058731036*y**5 - 0.08887338843352875*y**6 + 0.00010635995109959227*y**7)/exp(2*y)+fnfp*(-293.08883411077517 + 687.4173424742722*y - 587.5155393514971*y**2 + 230.79443643448388*y**3 - 42.43858774762262*y**4 + 3.1174084887336546*y**5 - 0.03498029115424334*y**6 + 0.00010635995109959255*y**7)/exp(2*y)+fnfp**2.*(-101.86950203987693 + 273.2061506861063*y - 275.726286739338*y**2 + 133.04692994947112*y**3 - 32.70104755171949*y**4 + 3.97732988126907*y**5 - 0.20339869588720422*y**6 + 0.0024586196200603624*y**7)/exp(2*y))+0.3628*((-190.97498404207045 + 416.8608262276174*y - 325.76552209218187*y**2 + 113.2385441547027*y**3 - 17.701680083840973*y**4 + 1.0332569156617533*y**5 - 0.004153563263125352*y**6 + 2.8934184610012863*10.**-6*y**7)/exp(2*y)+fnfp*(-141.6786207062133 + 356.9648895774077*y - 334.5013350598901*y**2 + 147.03628797775093*y**3 - 32.20918493521816*y**4 + 3.361307402125427*y**5 - 0.13314189795362072*y**6 + 0.00011600669876641137*y**7)/exp(2*y)+fnfp*(-250.588809950234 + 595.2078717615891*y - 512.1693434162119*y**2 + 200.96194870474423*y**3 - 36.80511594986847*y**4 + 2.761521476543859*y**5 - 0.04320808800223917*y**6 + 0.00011600669876641103*y**7)/exp(2*y)+fnfp**2.*(-185.90433263416065 + 504.16762153257406*y - 513.8112569285722*y**2 + 250.09669047429338*y**3 - 62.00326481873074*y**4 + 7.60737133156235*y**5 - 0.3937130809780268*y**6 + 0.004651091551417971*y**7)/exp(2*y))+0.0761*((-177.322002012884 + 386.7981764027574*y - 300.42150061015803*y**2 + 102.90348793862103*y**3 - 15.702546622916048*y**4 + 0.8863703283071965*y**5 - 0.003023032085734567*y**6 + 1.6964936570448065*10.**-6*y**7)/exp(2*y)+fnfp*(-226.80070452388915 + 577.0660024397152*y - 545.1761755643586*y**2 + 240.99347164323473*y**3 - 53.000576566466805*y**4 + 5.547385745653684*y**5 - 0.22034424513322584*y**6 + 0.00015264276384438938*y**7)/exp(2*y)+fnfp*(-243.71906664248888 + 590.938488996116*y - 516.7188179247523*y**2 + 205.5780241725279*y**3 - 38.33239807525766*y**4 + 3.01389271031282*y**5 - 0.061132415240810076*y**6 + 0.00015264276384438938*y**7)/exp(2*y)+fnfp**2.*(-311.72474590268195 + 868.9992676394133*y - 909.6241997748587*y**2 + 455.22711518083605*y**3 - 116.67276589404362*y**4 + 15.023120014472667*y**5 - 0.8527887771895357*y**6 + 0.01373409989321808*y**7)/exp(2*y))+0.2084*((-191.38551535189418 + 417.47688972239*y - 325.59723089485647*y**2 + 112.56132226733862*y**3 - 17.427699828060625*y**4 + 1.003167023560332*y**5 - 0.0033974203138163106*y**6 + 1.9305687585208373*10.**-6*y**7)/exp(2*y)+fnfp*(-135.79277660483086 + 318.38574583094663*y - 276.60903111112344*y**2 + 112.56309373360443*y**3 - 22.42682205407756*y**4 + 2.0309815045346844*y**5 - 0.06348232229485402*y**6 + 0.000044601362755116725*y**7)/exp(2*y)+fnfp*(-227.2061041868922 + 523.0741432139714*y - 434.07983511023576*y**2 + 162.46816129147405*y**3 - 27.95086128543361*y**4 + 1.9065220993110823*y**5 - 0.020860036206629122*y**6 + 0.000044601362755116725*y**7)/exp(2*y)+fnfp**2.*(-161.2083740630856 + 397.46009239613085*y - 365.2946992809805*y**2 + 159.202542444797*y**3 - 34.57617755569793*y**4 + 3.525184271412593*y**5 - 0.13521448547600368*y**6 + 0.0010304121781902643*y**7)/exp(2*y))
        return result
    elif newstr=='Argon':
        result= 0.+1.0*((-30.8163 + 42.5484*y - 18.3199*y**2 + 2.55984*y**3 - 0.0290861*y**4 + 0.000037498*y**5)/exp(2*y)+fnfp*(-47.7123 + 89.8139*y - 58.6968*y**2 + 15.7979*y**3 - 1.63357*y**4 + 0.0385981*y**5)/exp(2*y)+fnfp*(-39.0372 + 68.4592*y - 41.4232*y**2 + 10.0129*y**3 - 0.827777*y**4 + 0.0012029*y**5)/exp(2*y)+fnfp**2.*(-37.6645 + 56.8518*y - 26.952*y**2 + 4.47215*y**3 - 0.156429*y**4 + 0.0012029*y**5)/exp(2*y))
        return result
    elif newstr=='Xenon':
        result= 0.+0.0192*((-733.6577190190975 + 2202.7826087438502*y - 2541.8232235283513*y**2 + 1459.592847604118*y**3 - 452.5545643317905*y**4 + 76.03536042082504*y**5 - 6.4109713644766835*y**6 + 0.2081012925854394*y**7 - 1.330955037877538*10.**-9*y**8 + 1.7669255696699003*10.**-18*y**9)/exp(2*y)+fnfp*(-360.0499527730847 + 1225.0285897593212*y - 1615.7405805331339*y**2 + 1068.7475384444858*y**3 - 390.52644076018925*y**4 + 81.31458169093204*y**5 - 9.484881228084285*y**6 + 0.5705638955020632*y**7 - 0.01369236505082301*y**8 + 2.5933094557217835*10.**-11*y**9)/exp(2*y)+fnfp*(-1005.3507412741848 + 3289.558672835692*y - 4171.436919205304*y**2 + 2671.8628565800254*y**3 - 941.6893275144574*y**4 + 184.84791257645654*y**5 - 19.070070239787864*y**6 + 0.8462993390192723*y**7 - 0.005760703577999862*y**8 + 2.5933094557217835*10.**-11*y**9)/exp(2*y)+fnfp**2.*(-493.38605392187486 + 1811.69855119445*y - 2605.079777106582*y**2 + 1905.6413923991174*y**3 - 781.6382331017134*y**4 + 186.00585349269195*y**5 - 25.392769466691647*y**6 + 1.8568744149775716*y**7 - 0.0598011977556028*y**8 + 0.0003790347119449581*y**9)/exp(2*y))+0.2644*((-607.4703572357896 + 1823.9076459512537*y - 2093.0775742640117*y**2 + 1188.9805323896114*y**3 - 362.13455154525724*y**4 + 59.12435911720566*y**5 - 4.756983401834785*y**6 + 0.1420969751819569*y**7 + 1.8858524300584882*10.**-9*y**8 + 5.322064968885241*10.**-18*y**9)/exp(2*y)+fnfp*(-579.2742476172738 + 1955.215838458502*y - 2558.996089314389*y**2 + 1678.5822707129057*y**3 - 604.5883853376384*y**4 + 122.47011224943522*y**5 - 13.608426931926704*y**6 + 0.7567249965022569*y**7 - 0.016316461613285007*y**8 - 6.772590370033333*10.**-11*y**9)/exp(2*y)+fnfp*(-843.6383290637565 + 2782.081760697798*y - 3547.226645557811*y**2 + 2284.5869560698516*y**3 - 810.8295481878994*y**4 + 160.78938622134976*y**5 - 16.89047751392344*y**6 + 0.7841214781346997*y**7 - 0.007425417573357348*y**8 - 6.772590378548638*10.**-11*y**9)/exp(2*y)+fnfp**2.*(-804.480338025471 + 2952.877421499789*y - 4253.111385014633*y**2 + 3127.812624915991*y**3 - 1291.786699679334*y**4 + 309.08422654223955*y**5 - 42.27666043433074*y**6 + 3.089159281789595*y**7 - 0.10103753368862518*y**8 + 0.0008526333993372912*y**9)/exp(2*y))+0.0408*((-666.0095074246402 + 1999.6718656724865*y - 2296.7440838447505*y**2 + 1304.9553004787679*y**3 - 397.94060575123086*y**4 + 65.36974744318988*y**5 - 5.35511372058455*y**6 + 0.16759012647495813*y**7 + 2.292699020101519*10.**-9*y**8 + 6.3864779626622895*10.**-18*y**9)/exp(2*y)+fnfp*(-540.0941636622586 + 1837.5885658390048*y - 2418.444801493977*y**2 + 1591.8355837151564*y**3 - 577.1351065989223*y**4 + 118.87485134917861*y**5 - 13.674262323483921*y**6 + 0.8084914432765211*y**7 - 0.019010219529754693*y**8 - 7.369819906707093*10.**-11*y**9)/exp(2*y)+fnfp*(-937.2860167218415 + 3097.937918387352*y - 3954.476496701828*y**2 + 2541.4027865778553*y**3 - 896.7222625153936*y**4 + 176.23084941313257*y**5 - 18.29236658158858*y**6 + 0.8352212880251604*y**7 - 0.007517437171664199*y**8 - 7.369819889676485*10.**-11*y**9)/exp(2*y)+fnfp**2.*(-760.0833046230839 + 2816.1866093900067*y - 4081.223274840993*y**2 + 3006.6427588981423*y**3 - 1241.8873285116924*y**4 + 297.9289790809058*y**5 - 41.13862671493953*y**6 + 3.0695101997583327*y**7 - 0.10375963513554494*y**8 + 0.000852724743941017*y**9)/exp(2*y))+0.2118*((-552.7787751625096 + 1659.5031625953268*y - 1895.3946048988244*y**2 + 1065.501901791203*y**3 - 319.34921442224066*y**4 + 51.02519020193409*y**5 - 3.99301343302149*y**6 + 0.11496123118729151*y**7 - 4.226690989370344*10.**-9*y**8 + 3.2528461089826596*10.**-17*y**9)/exp(2*y)+fnfp*(-766.2956873148726 + 2590.001233367625*y - 3387.118928151013*y**2 + 2213.8732858647*y**3 - 792.5134656817123*y**4 + 159.1753741213242*y**5 - 17.498872900852277*y**6 + 0.9613133932362938*y**7 - 0.020513540257137315*y**8 + 2.2244455379719942*10.**-10*y**9)/exp(2*y)+fnfp*(-788.1714676310007 + 2624.1899455797306*y - 3365.619480880513*y**2 + 2173.326712395175*y**3 - 771.8473280028425*y**4 + 153.24180590132625*y**5 - 16.200199141238564*y**6 + 0.771370413396892*y**7 - 0.00863768429498768*y**8 + 2.2244455413781156*10.**-10*y**9)/exp(2*y)+fnfp**2.*(-1092.6114092074356 + 4050.601817759749*y - 5883.5199450077835*y**2 + 4358.404750746443*y**3 - 1812.8553140519577*y**4 + 437.49427948074197*y**5 - 60.608099568578474*y**6 + 4.529477791646773*y**7 - 0.15548653150218847*y**8 + 0.001537239870081146*y**9)/exp(2*y))+0.2689*((-620.9089406741449 + 1864.2593224410844*y - 2134.890927338464*y**2 + 1204.9165960787986*y**3 - 363.53729888517864*y**4 + 58.82780670908334*y**5 - 4.721893702823104*y**6 + 0.14364555973773357*y**7 - 1.2552503016990131*10.**-10*y**8)/exp(2*y)+fnfp*(-720.0203067509186 + 2449.8143366854674*y - 3219.07675205449*y**2 + 2111.0118457749495*y**3 - 760.8278035379105*y**4 + 155.3909728444332*y**5 - 17.674291169592557*y**6 + 1.0298440359120358*y**7 - 0.023781340690539565*y**8 + 5.777345827795261*10.**-12*y**9)/exp(2*y)+fnfp*(-896.8367461049653 + 2992.49961713192*y - 3846.144515219064*y**2 + 2483.889868127141*y**3 - 879.7954271342398*y**4 + 173.69534195142052*y**5 - 18.194779801737408*y**6 + 0.853507806671897*y**7 - 0.009157069406360468*y**8 + 5.777345827795261*10.**-12*y**9)/exp(2*y)+fnfp**2.*(-1039.992544373555 + 3886.12251551119*y - 5672.886847159265*y**2 + 4206.4556063842365*y**3 - 1748.5110030719222*y**4 + 422.5052865725764*y**5 - 58.925433737381056*y**6 + 4.472374338146091*y**7 - 0.15711936203053348*y**8 + 0.0015160049418550317*y**9)/exp(2*y))+0.1044*((-484.20199703640645 + 1460.0453624134452*y - 1661.1193071594553*y**2 + 918.0816501430805*y**3 - 267.34481160018544*y**4 + 41.21066978219259*y**5 - 3.1291351259711497*y**6 + 0.09373180621803237*y**7 - 0.0004722611170131605*y**8 + 5.24635021047412*10.**-7*y**9)/exp(2*y)+fnfp*(-1059.2131736146407 + 3588.5961782584695*y - 4681.705811028789*y**2 + 3035.2396004472466*y**3 - 1073.3799035936804*y**4 + 212.55789117729262*y**5 - 23.052911211661126*y**6 + 1.255115071383488*y**7 - 0.027088878876281166*y**8 + 0.00003979972312664608*y**9)/exp(2*y)+fnfp*(-717.2204908972566 + 2430.222632653121*y - 3148.2538071637114*y**2 + 2034.0080189226614*y**3 - 717.334805037882*y**4 + 141.17045745554552*y**5 - 14.945603344583903*y**6 + 0.7489371898715126*y**7 - 0.012141736312106678*y**8 + 0.000039799723126646585*y**9)/exp(2*y)+fnfp**2.*(-1568.951381849864 + 5900.839667103454*y - 8657.26680451689*y**2 + 6452.589464637943*y**3 - 2696.5400269320585*y**4 + 655.1056132649079*y**5 - 91.96774597780168*y**6 + 7.068857345098202*y**7 - 0.2582384533618406*y**8 + 0.0030192760631853476*y**9)/exp(2*y))+0.0887*((-486.892432416903 + 1468.166530771918*y - 1671.2834862719099*y**2 + 925.0573422531022*y**3 - 270.0074510732534*y**4 + 41.74407446062155*y**5 - 3.179134831606973*y**6 + 0.09533408362887742*y**7 - 0.00047704902230948077*y**8 + 5.305814160029576*10.**-7*y**9)/exp(2*y)+fnfp*(-1079.9984460781504 + 3676.656274705886*y - 4806.217252633338*y**2 + 3111.927397085528*y**3 - 1098.1155329995029*y**4 + 217.45211281871954*y**5 - 23.708763593302*y**6 + 1.3083050295529477*y**7 - 0.02873398961077722*y**8 + 0.000042545323547385776*y**9)/exp(2*y)+fnfp*(-739.3546862241323 + 2518.379952978401*y - 3284.8697990022797*y**2 + 2140.8311399965282*y**3 - 762.6869524378959*y**4 + 151.75269212951164*y**5 - 16.240843750598696*y**6 + 0.8200652852438197*y**7 - 0.013160387576545163*y**8 + 0.000042545323547385776*y**9)/exp(2*y)+fnfp**2.*(-1639.9965558284582 + 6223.985477241586*y - 9204.547777025013*y**2 + 6903.34567240627*y**3 - 2901.024318237357*y**4 + 709.6047448433417*y**5 - 100.61416836967213*y**6 + 7.847845703269501*y**7 - 0.29200733705623083*y**8 + 0.0034115491066170497*y**9)/exp(2*y))
        return result
    elif newstr=='Helium':
        result= 0.+1.0*(0.+fnfp*0.+fnfp*0.+fnfp**2.*0.)
        return result
    elif newstr=='Fluorine':
        result= 0.+1.0*((-1.7821347540105579 + 1.7689338046101344*y - 0.5091128016430709*y**2 + 0.03467233498367796*y**3)/exp(2*y)+fnfp*(-4.546003558834712 + 4.512329517693987*y - 1.298683241616114*y**2 + 0.08844480038822462*y**3)/exp(2*y)+fnfp*(-1.9801496623904304 + 2.1121596504680973*y - 0.6968189349268731*y**2 + 0.06751160728882259*y**3)/exp(2*y)+fnfp**2.*(-5.051114901381312 + 5.387855849440946*y - 1.7774981745538856*y**2 + 0.1722136865993883*y**3)/exp(2*y))
        return result

def factor_SigPDelta(str newstr, DTYPE_t y, DTYPE_t fnfp):
    cdef DTYPE_t result
    if newstr=='Iodine':
        result= 0.+1.0*((-0.3734344761000902 + 1.5913728456507685*y - 3.132043211990993*y**2 + 3.3827535862512015*y**3 - 2.101466029666743*y**4 + 0.7287822221646963*y**5 - 0.12779817323119572*y**6 + 0.008580503477283567*y**7 - 2.354859143276579*10.**-10*y**8 + 2.498598626538102*10.**-18*y**9)/exp(2*y)+fnfp*(-0.16143538054844486 + 0.7525222405793649*y - 1.4647858700656131*y**2 + 1.4630039217515076*y**3 - 0.8208346263123252*y**4 + 0.2629620549399163*y**5 - 0.046844093804281256*y**6 + 0.004256566927970423*y**7 - 0.00014997525517189956*y**8 + 1.440292525797695*10.**-12*y**9)/exp(2*y)+fnfp*(-0.09265238823701115 + 0.48179153308508177*y - 0.8494507077486693*y**2 + 0.7949770042074121*y**3 - 0.4269344474864306*y**4 + 0.1292961109998628*y**5 - 0.02123694067101126*y**6 + 0.0017185276552759328*y**7 - 0.00005224305353967539*y**8 + 1.4402925259085714*10.**-12*y**9)/exp(2*y)+fnfp**2.*(-0.04005354221701587 + 0.22429922298073465*y - 0.42523960544723094*y**2 + 0.3825540365917758*y**3 - 0.18759716407093383*y**4 + 0.05345148668267608*y**5 - 0.00901210048309272*y**6 + 0.0008789050306872622*y**7 - 0.00004548085344793924*y**8 + 9.61105819727057*10.**-7*y**9)/exp(2*y))
        return result
    elif newstr=='Sodium':
        result= 0.+1.0*((-0.250943028108045 + 0.4795086837165022*y - 0.291898477007095*y**2 + 0.049470874295030005*y**3)/exp(2*y)+fnfp*(-0.08825103658249984 + 0.16863245298080762*y - 0.08116242304681649*y**2 + 0.010706613950468504*y**3)/exp(2*y)+fnfp*(-0.020185614481473296 + 0.030719267202120096*y - 0.007625645941127293*y**2 - 0.0002670025521764062*y**3)/exp(2*y)+fnfp**2.*(-0.0070988280307103845 + 0.010803277517136898*y - 0.00302157196768802*y**2 - 0.00004594089144476401*y**3)/exp(2*y))
        return result
    elif newstr=='Germanium':
        result= 0.+0.2754*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0773*((-0.0011831850906478258 + 0.002370402896777368*y - 0.0033280796336258973*y**2 + 0.0023028685829217066*y**3 - 0.0008838558715501773*y**4 + 0.0001502823525854596*y**5 - 5.872526227603095*10.**-6*y**6 + 6.445731171828481*10.**-8*y**7)/exp(2*y)+fnfp*(-0.024709740568242752 + 0.0576306311966314*y - 0.07441894563008883*y**2 + 0.05349675407548963*y**3 - 0.020222766203296827*y**4 + 0.0036383802407740436*y**5 - 0.0002904234683713272*y**6 + 9.351205665796982*10.**-6*y**7)/exp(2*y)+fnfp*(-0.07106472086564807 + 0.2890145809192445*y - 0.3831175907618362*y**2 + 0.23905195566520757*y**3 - 0.07469610094258396*y**4 + 0.011068277908306239*y**5 - 0.0006562550771254197*y**6 + 9.351205665797253*10.**-6*y**7)/exp(2*y)+fnfp**2.*(-1.484121825084149 + 6.523927170749099*y - 10.070834186616198*y**2 + 7.114237357010658*y**3 - 2.5842410410757997*y**4 + 0.49476718148805915*y**5 - 0.04823231595185085*y**6 + 0.001923151698998912*y**7)/exp(2*y))+0.3628*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0761*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2084*(0+fnfp*0+fnfp*0+fnfp**2.*0)
        return result
    elif newstr=='Argon':
        result= 0.+1.0*(0.+fnfp*0.+fnfp*0.+fnfp**2.*0.)
        return result
    elif newstr=='Xenon':
        result= 0.+0.0192*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2644*((-0.003975208645271652 + 0.013577944391787064*y - 0.033335615436831126*y**2 + 0.03991029245865698*y**3 - 0.024263329966056752*y**4 + 0.007622187973978606*y**5 - 0.0011494192334069845*y**6 + 0.00006508904984946703*y**7 + 2.9738880246435268*10.**-12*y**8 + 3.2930276994977433*10.**-20*y**9)/exp(2*y)+fnfp*(0.0004380644591316903 + 0.0008345236781888002*y - 0.0010458201210233969*y**2 + 0.006730011544120212*y**3 - 0.0008974528532349767*y**4 - 0.001798092795579307*y**5 + 0.00037081743043587787*y**6 + 0.00003503910182751983*y**7 - 7.659297438993351*10.**-6*y**8 - 1.4460796784153215*10.**-13*y**9)/exp(2*y)+fnfp*(-0.1361078932316696 + 0.6138480670741837*y - 1.072481132071152*y**2 + 0.9498613812152246*y**3 - 0.46793427527303033*y**4 + 0.12896060026795841*y**5 - 0.018569442338998664*y**6 + 0.0011117999682842172*y**7 - 5.393888710297954*10.**-6*y**8 - 1.4460796784153215*10.**-13*y**9)/exp(2*y)+fnfp**2.*(0.014998968847334567 + 0.012159211617507007*y - 0.13073578212741144*y**2 + 0.11447147333566586*y**3 + 0.017891900370202118*y**4 - 0.030205783111746824*y**5 + 0.004988832475687152*y**6 + 0.0005149030479562064*y**7 - 0.0001225250384668647*y**8 + 6.347242218807455*10.**-7*y**9)/exp(2*y))+0.0408*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.2118*((0.001609067496318168 - 0.008139639696145996*y + 0.004703026751910718*y**2 + 0.004914860393119773*y**3 - 0.006064360743877452*y**4 + 0.0023458642474660273*y**5 - 0.0003850111222814642*y**6 + 0.00002284905079257533*y**7 - 8.524581541515193*10.**-12*y**8 + 8.021349795291725*10.**-19*y**9)/exp(2*y)+fnfp*(0.008049884589307242 - 0.04140544633209587*y + 0.026809474804211395*y**2 + 0.0199879363996526*y**3 - 0.037922319689730866*y**4 + 0.019691060011272316*y**5 - 0.004152045328809223*y**6 + 0.00031726704027153197*y**7 - 2.504904804469874*10.**-6*y**8 + 4.3181064047117437*10.**-13*y**9)/exp(2*y)+fnfp*(0.06267463230834691 - 0.36910591625232314*y + 0.7174706265585548*y**2 - 0.6820780251779602*y**3 + 0.34986598724451107*y**4 - 0.09773282583841718*y**5 + 0.013852796307189217*y**6 - 0.0007697010536819695*y**7 - 2.1633708464556747*10.**-6*y**8 + 4.3181064047117437*10.**-13*y**9)/exp(2*y)+fnfp**2.*(0.31355027549428405 - 1.8732246405045063*y + 3.823032427933379*y**2 - 4.106071344732948*y**3 + 2.5222906679907218*y**4 - 0.8683140945658252*y**5 + 0.15318902767333598*y**6 - 0.011066137282280881*y**7 + 0.00005948355463103935*y**8 + 2.357098325503625*10.**-7*y**9)/exp(2*y))+0.2689*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.1044*(0+fnfp*0+fnfp*0+fnfp**2.*0)+0.0887*(0+fnfp*0+fnfp*0+fnfp**2.*0)
        return result
    elif newstr=='Helium':
        result= 0.+1.0*(0.+fnfp*0.+fnfp*0.+fnfp**2.*0.)
        return result
    elif newstr=='Fluorine':
        result= 0.+1.0*((-0.2127508736800487 + 0.3708877082042609*y - 0.20982821805829413*y**2 + 0.038205309826159016*y**3)/exp(2*y)+fnfp*(0.18079195210155527 - 0.31517385389242*y + 0.17830833073710328*y**2 - 0.03246620060655367*y**3)/exp(2*y)+fnfp*(0.0039003489667765344 - 0.005918959554546226*y + 0.00016252380997721432*y**2 + 0.0006324016708628067*y**3)/exp(2*y)+fnfp**2.*(-0.0033144479803231004 + 0.005029827768819689*y - 0.00013810987640384108*y**2 - 0.0005374038217089391*y**3)/exp(2*y))
        return result

